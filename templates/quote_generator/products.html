{% extends "quote_generator/base.html" %}

{% block page_title %}
    {% if result.manufacturer %}
	Products by {{ result.manufacturer }}
    {% endif %}
    {% if result.category %}
	Products in category: {{ result.category }}
    {% endif %}
{% endblock %}

{% block page_css %}
    <link rel="stylesheet" href="/site_media/js/jquery/dialog/css/jquery-ui.custom.css"/>
    <style type="text/css">
	/*demo page css*/
	.demoHeaders { margin-top: 2em; }
	#dialog_link {padding: .4em 1em .4em 20px;text-decoration: none;position: relative;}
	#dialog_link span.ui-icon {margin: 0 5px 0 0;position: absolute;left: .2em;top: 50%;margin-top: -8px;}
	ul#icons {margin: 0; padding: 0;}
	ul#icons li {margin: 2px; position: relative; padding: 4px 0; cursor: pointer; float: left;  list-style: none;}
	ul#icons span.ui-icon {float: left; margin: 0 4px;}
    </style>
{% endblock %}

{% block page_js %}
    <script type="text/javascript" src="/site_media/js/jquery/dialog/jquery-dialog.js"></script>
    <script type="text/javascript">
	$(function()	{

	    $(".product-detail").hover(
		function()  {
		    $(this).find("#add-quote-item").show();
		},
		function()  {
		    $(this).find("#add-quote-item").hide();
		}
	    );

	    $("#msger").ajaxStart(function()	{
		$(this).slideDown("fast");
	    });

	    $(function(){
		// Dialog			
		$('#form').dialog({
		    autoOpen: false,
		    width: 600,
		    buttons: {
			"Ok": function() { 
				$(this).dialog("close"); 
			}, 
			"Cancel": function() { 
				$(this).dialog("close"); 
			} 
		    },
		    modal: true
		});
		    
		// Dialog Link
		$('#dialog_link').click(function(){
		    $('#form').dialog('open');
		    return false;
		});
		
		//hover states on the static widgets
		$('#dialog_link, ul#icons li').hover(
		    function() { $(this).addClass('ui-state-hover'); }, 
		    function() { $(this).removeClass('ui-state-hover'); }
		);
		    
	    });

	});
    </script>
{% endblock %}

{% block main %}
    <div class="widget">
	{% if result.manufacturer %}
	    <h1>Products by {{ result.manufacturer }}</h1>
	{% endif %}
	{% if result.category %}
	    <h1>Products In Category: {{ result.category }}</h1>
	{% endif %}
	<p>Hover over products to add.</p>
	<table width="100%" class="product-list padtop">
	    <input id="quote-id" name="quote-id" type="hidden" value="{{ result.quote }}"/>
	    <thead>
		<tr>
		    <th id="header-1"><h3>Product</h3></th>
		    <th id="header-2">
			<h3>
			{% if result.manufacturer %}
			    Categories
			{% endif %}
			{% if result.category %}
			    Manufacturer
			{% endif %}
			</h3>
		    </th>
		    <th id="header-3">&nbsp;</th>
		</tr>
	    </thead>
	    <tbody>
	    {% for p in result.products %}
		<tr class="product-detail">
		    <td>
			<h4><a target="blank" href="{{ result.product_index }}{{ p.product_page }}">{{ p.name }}</a></h4>
			<p>{{ p.short_description }}</p>
			<p><a target="blank" href="{{ result.specs_index }}{{ p.specs_page }}">Specifications</a></p>
		    </td>
		    <td>
		    {% if result.manufacturer %}
			{% for c in p.categories.values %}
			    <p class="padtop">{{ c.name }}</p>
			{% endfor %}
		    {% endif %}
		    {% if result.category %}
			<p class="padtop">{{ p.manufacturer }}</p>
		    {% endif %}
		    </td>
		    <td id="cell{{ p.pk }}">
			<form id="add-quote-item">
			    <input id="quantity{{ p.pk }}" name="quantity" type="text"/>
			    <input type="button" value="Add" id="{{ p.pk }}" onclick="quote(this.value, this.id)"/>
			</form>
			<form class="rem-quote-item">
			    <input type="button" value="Remove" id="{{ p.pk }}" onclick="quote(this.value, this.id)"/>
			</form>
		    </td>
		</tr>
	    {% endfor %}
		<tr>
		    <td></td>
		    <td><p><a href="/product_groups/?quote_id={{ result.quote }}">More Products</a></p></td>
		    <!--<td><p><a href="/quote/{{ result.quote }}/preview/">Preview Quote</a></p></td>-->
		    <td><p><a id="preview" href="#test">Preview Quote</a></p></td>
		</tr>
	    </tbody>
	</table>
    </div>
    <p><a href="#" id="dialog_link" class="ui-state-default ui-corner-all">
	    <span class="ui-icon ui-icon-newwin"></span>Open Dialog</a>
	</p>
    <div id="form" title="Dialog Title">
	<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et 
	dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex 
	ea commodo consequat.</p>
	<input type="text"/>
    </div>
{% endblock %}
